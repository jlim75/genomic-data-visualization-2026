---
layout: post
title:  "Spatial distribution of transcription factor Krüppel‐like\nfactor 5 (KLF5) gene expression in coronal kidney section"
author: Jamie Lim
jhed: jlim75
categories: [ HW1 ]
image: homework/hw1/hw1_jlim75.png
featured: false
---

### 1. What data types are you visualizing?
The represented data type is quantitative (x and y spatial positions of cells as well as levels of KLF5 gene expression on the log scale).

### 2. What data encodings (geometric primitives and visual channels) are you using to visualize these data types?
I have visualized this quantitative data by using the geometric primitive of points to represent cells within the coronal kidney section. I have used the visual channel of position along the x- and y-axes to encode the x and y spatial positions, respectively, of these cells. Furthermore, I have used the visual channel of color hue to encode the levels of gene expression on the log scale. Magenta and indigo-colored points represent cells with higher expression while yellow and orange-colored points represent cells with lower expression.

### 3. What about the data are you trying to make salient through this data visualization? 
I would like to make salient the spatial distribution of KLF5 gene expression in the provided coronal kidney section. Transcription factor Krüppel‐like factor 5 (KLF5) plays an important role in the tumor microenvironment by regulating gene expression, cell proliferation, and apoptosis. Studies have indicated that KLF5 may serve as a tumor suppressor due to its downregulation in renal cancer cell lines and patient tumor samples. Through this data visualization, I aim to emphasize the patterns of KLF5 gene expression, specifically its localization at the center of the kidney section, which may suggest immune cell infiltration in this region.

### 4. What Gestalt principles or knowledge about perceptiveness of visual encodings are you using to accomplish this?
I relied on the Gestalt Principle of Similarity to encourage viewers to perceive different-colored points as separate groups. This allows the viewer to distinguish between levels of KLF5 gene expression. The viewer can also notice localized patterns of expression by searching for regions with many magenta and indigo-colored points. Moreover, the perception chart states that human viewers can more easily understand quantitative data when it is encoded using position. Therefore, I used position to encode the x and y spatial positions of cells.

### 5. Code (paste your code in between the ``` symbols)

```r
file <- '~/Desktop/genomic-data-visualization-2025/data/pikachu.csv.gz'
data <- read.csv(file, row.names=1)

library(ggplot2)
ggplot(data, aes(x=aligned_x, y=ERBB2, col=cell_area, size=aligned_y)) + 
  scale_colour_gradient(low = 'lightgrey', high='red') + 
  geom_point() +
  theme_minimal() 
```
